graph TB
    %% Session & Context Management
    subgraph "ğŸ” Session Management Layer"
        WebSocket[ğŸ”Œ WebSocket Connection<br/>Real-time Communication]
        SessionDB[(ğŸ’¾ Session Database<br/>Redis/MongoDB<br/>- User Sessions<br/>- Conversation History<br/>- Context State)]
        AuthService[ğŸ” Authentication Service<br/>JWT Token Management]
    end
    
    %% Input Processing Pipeline
    subgraph "ğŸ“¥ Enhanced Input Processing"
        UserInput[ğŸ‘¤ User Input<br/>Text/Voice/Upload]
        InputValidator[âœ… Input Validator<br/>Sanitization & Validation]
        ContextLoader[ğŸ“ Context Loader<br/>Load Previous Conversation]
        IntentClassifier[ğŸ¯ Intent Classifier<br/>- New Query<br/>- Follow-up<br/>- Clarification<br/>- Feedback]
    end
    
    %% NLP & Understanding
    subgraph "ğŸ§  NLP Processing Engine"
        MultilingualNLP[ğŸŒ Multilingual NLP<br/>Hindi/English/Bengali<br/>Gemma2 1B + Custom Fine-tuning]
        EntityExtractor[ğŸ·ï¸ Enhanced Entity Extraction<br/>- Legal Entities<br/>- Temporal References<br/>- Contextual Entities]
        ConversationNLU[ğŸ’¬ Conversation NLU<br/>- Coreference Resolution<br/>- Context Linking<br/>- Intent Progression]
    end
    
    %% Conversation State Management
    subgraph "ğŸ—ƒï¸ Conversation State Management"
        StateManager[ğŸ­ State Manager<br/>Current Conversation State]
        TopicTracker[ğŸ“Š Topic Tracker<br/>Legal Domain Progression]
        ProgressTracker[ğŸ“ˆ Progress Tracker<br/>User Journey Mapping]
        MemoryManager[ğŸ§  Memory Manager<br/>Short/Long-term Context]
    end
    
    %% Agentic Conversation System
    subgraph "ğŸ¤– Agentic Conversation System (LangGraph)"
        ConversationOrchestrator[ğŸ­ Conversation Orchestrator<br/>LangGraph Multi-Agent Coordinator]
        
        subgraph "ğŸ’¬ Conversation Management Agents"
            DialogueAgent[ğŸ’¬ Dialogue Management Agent<br/>Turn-taking & Flow Control]
            ClarificationAgent[â“ Clarification Agent<br/>Gap Detection & Question Generation]
            ContextAgent[ğŸ“ Context Maintenance Agent<br/>Information Synthesis]
            ProgressAgent[ğŸ“Š Progress Tracking Agent<br/>Goal Achievement Monitoring]
        end
        
        subgraph "âš–ï¸ Legal Domain Agents"
            LegalClassifier[ğŸ“Š Legal Classification Agent<br/>Domain & Confidence Scoring]
            LegalResearcher[ğŸ” Legal Research Agent<br/>Case Law & Statute Retrieval]
            RiskAnalyzer[ğŸš¨ Risk Analysis Agent<br/>Urgency & Complexity Assessment]
            ProcessGuide[ğŸ“‹ Process Guide Agent<br/>Step-by-step Procedure Mapping]
        end
        
        subgraph "ğŸ¯ Recommendation Agents"
            AdvocateMatchmaker[ğŸ‘¨â€ğŸ’¼ Advocate Matching Agent<br/>ML-based Recommendation]
            ActionPlanner[âœ… Action Planning Agent<br/>Next Steps & Prioritization]
            ResourceProvider[ğŸ“š Resource Provider Agent<br/>Document & Template Suggestions]
            TimelineAgent[â° Timeline Agent<br/>Deadline & Schedule Management]
        end
        
        subgraph "ğŸ“ Response Generation Agents"
            ResponseStrategist[ğŸ¯ Response Strategy Agent<br/>Conversation Planning]
            ContentGenerator[ğŸ“ Content Generation Agent<br/>Ollama 3.1 3B + Legal Fine-tuning]
            ToneAdapter[ğŸ­ Tone Adaptation Agent<br/>User-appropriate Communication]
            QualityController[âœ… Quality Control Agent<br/>Response Validation]
        end
    end
    
    %% Decision Making & Flow Control
    subgraph "ğŸ”„ Conversation Flow Control"
        FlowDecisionEngine[ğŸ¯ Flow Decision Engine<br/>Next Action Determination]
        
        ConversationFlows{ğŸ›£ï¸ Conversation Flows}
        ConversationFlows -->|Information Gathering| InfoGathering[ğŸ“‹ Information Gathering Flow]
        ConversationFlows -->|Legal Guidance| GuidanceFlow[âš–ï¸ Legal Guidance Flow]
        ConversationFlows -->|Clarification Loop| ClarificationFlow[â“ Clarification Flow]
        ConversationFlows -->|Recommendation| RecommendationFlow[ğŸ‘¨â€ğŸ’¼ Recommendation Flow]
        ConversationFlows -->|Progress Check| ProgressFlow[ğŸ“Š Progress Review Flow]
        ConversationFlows -->|Closure| ClosureFlow[âœ… Conversation Closure]
    end
    
    %% Response Assembly & Delivery
    subgraph "ğŸ”§ Response Assembly Engine"
        ResponseAssembler[ğŸ”§ Response Assembler<br/>Multi-component Integration]
        
        subgraph "ğŸ“± Response Formats"
            ConversationalResponse[ğŸ’¬ Conversational Response<br/>Natural Language + Context]
            StructuredGuidance[ğŸ“‹ Structured Guidance<br/>Process Steps + Documents]
            InteractiveOptions[ğŸ® Interactive Options<br/>Quick Replies + Actions]
            ProgressDashboard[ğŸ“Š Progress Dashboard<br/>Visual Progress Tracking]
            RecommendationCards[ğŸ¯ Recommendation Cards<br/>Advocate Profiles + Actions]
        end
        
        ResponseRenderer[ğŸ¨ Response Renderer<br/>Multi-format Output Generation]
        DeliveryEngine[ğŸ“¤ Delivery Engine<br/>WebSocket + Push Notifications]
    end
    
    %% Feedback & Interaction Handling
    subgraph "ğŸ® Interaction Management"
        InteractionHandler[ğŸ® Interaction Handler<br/>User Action Processing]
        FeedbackCollector[ğŸ“ Feedback Collector<br/>Satisfaction & Improvement Data]
        ConversationAnalyzer[ğŸ“Š Conversation Analyzer<br/>Turn Analysis & Optimization]
        A11yManager[â™¿ Accessibility Manager<br/>Screen Reader + Voice Support]
    end
    
    %% Learning & Adaptation
    subgraph "ğŸ“ Learning & Adaptation System"
        ConversationLearner[ğŸ“ Conversation Learning Engine<br/>Pattern Recognition & Improvement]
        ModelTrainer[ğŸ‹ï¸ Model Training Pipeline<br/>Continuous Learning from Interactions]
        PersonalizationEngine[ğŸ¯ Personalization Engine<br/>User-specific Adaptation]
        PerformanceMonitor[ğŸ“ˆ Performance Monitor<br/>Conversation Success Metrics]
    end
    
    %% Technical Flow Connections
    WebSocket --> UserInput
    UserInput --> InputValidator
    InputValidator --> ContextLoader
    ContextLoader --> SessionDB
    SessionDB --> AuthService
    
    ContextLoader --> IntentClassifier
    IntentClassifier --> MultilingualNLP
    MultilingualNLP --> EntityExtractor
    EntityExtractor --> ConversationNLU
    
    ConversationNLU --> StateManager
    StateManager --> TopicTracker
    TopicTracker --> ProgressTracker
    ProgressTracker --> MemoryManager
    
    MemoryManager --> ConversationOrchestrator
    ConversationOrchestrator --> DialogueAgent
    ConversationOrchestrator --> ClarificationAgent
    ConversationOrchestrator --> ContextAgent
    ConversationOrchestrator --> ProgressAgent
    
    DialogueAgent --> LegalClassifier
    ClarificationAgent --> LegalResearcher
    ContextAgent --> RiskAnalyzer
    ProgressAgent --> ProcessGuide
    
    LegalClassifier --> AdvocateMatchmaker
    LegalResearcher --> ActionPlanner
    RiskAnalyzer --> ResourceProvider
    ProcessGuide --> TimelineAgent
    
    AdvocateMatchmaker --> ResponseStrategist
    ActionPlanner --> ContentGenerator
    ResourceProvider --> ToneAdapter
    TimelineAgent --> QualityController
    
    ResponseStrategist --> FlowDecisionEngine
    ContentGenerator --> FlowDecisionEngine
    ToneAdapter --> FlowDecisionEngine
    QualityController --> FlowDecisionEngine
    
    FlowDecisionEngine --> ConversationFlows
    InfoGathering --> ResponseAssembler
    GuidanceFlow --> ResponseAssembler
    ClarificationFlow --> ResponseAssembler
    RecommendationFlow --> ResponseAssembler
    ProgressFlow --> ResponseAssembler
    ClosureFlow --> ResponseAssembler
    
    ResponseAssembler --> ConversationalResponse
    ResponseAssembler --> StructuredGuidance
    ResponseAssembler --> InteractiveOptions
    ResponseAssembler --> ProgressDashboard
    ResponseAssembler --> RecommendationCards
    
    ConversationalResponse --> ResponseRenderer
    StructuredGuidance --> ResponseRenderer
    InteractiveOptions --> ResponseRenderer
    ProgressDashboard --> ResponseRenderer
    RecommendationCards --> ResponseRenderer
    
    ResponseRenderer --> DeliveryEngine
    DeliveryEngine --> WebSocket
    DeliveryEngine --> InteractionHandler
    
    InteractionHandler --> FeedbackCollector
    FeedbackCollector --> ConversationAnalyzer
    ConversationAnalyzer --> A11yManager
    A11yManager --> SessionDB
    
    SessionDB --> ConversationLearner
    ConversationLearner --> ModelTrainer
    ModelTrainer --> PersonalizationEngine
    PersonalizationEngine --> PerformanceMonitor
    PerformanceMonitor --> ConversationOrchestrator
    
    %% Styling
    classDef sessionStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef inputStyle fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef nlpStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef stateStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef agentStyle fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef flowStyle fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    classDef responseStyle fill:#fff8e1,stroke:#ff8f00,stroke-width:2px
    classDef interactionStyle fill:#f1f8e9,stroke:#558b2f,stroke-width:2px
    classDef learningStyle fill:#e8eaf6,stroke:#3f51b5,stroke-width:2px
    
    class WebSocket,SessionDB,AuthService sessionStyle
    class UserInput,InputValidator,ContextLoader,IntentClassifier inputStyle
    class MultilingualNLP,EntityExtractor,ConversationNLU nlpStyle
    class StateManager,TopicTracker,ProgressTracker,MemoryManager stateStyle
    class ConversationOrchestrator,DialogueAgent,ClarificationAgent,ContextAgent,ProgressAgent,LegalClassifier,LegalResearcher,RiskAnalyzer,ProcessGuide,AdvocateMatchmaker,ActionPlanner,ResourceProvider,TimelineAgent,ResponseStrategist,ContentGenerator,ToneAdapter,QualityController agentStyle
    class FlowDecisionEngine,ConversationFlows,InfoGathering,GuidanceFlow,ClarificationFlow,RecommendationFlow,ProgressFlow,ClosureFlow flowStyle
    class ResponseAssembler,ConversationalResponse,StructuredGuidance,InteractiveOptions,ProgressDashboard,RecommendationCards,ResponseRenderer,DeliveryEngine responseStyle
    class InteractionHandler,FeedbackCollector,ConversationAnalyzer,A11yManager interactionStyle
    class ConversationLearner,ModelTrainer,PersonalizationEngine,PerformanceMonitor learningStyle